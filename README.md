## MyCPU

> 浙江大学计算机系统系列贯通课程实验项目

> 此仓库仅存储项目中编写的部分代码，项目整体工具链和环境配置请参考 `[浙江大学计算机系统贯通课程仓库](http://git-zju-edu-cn-s.webvpn.zju.edu.cn:8001/zju-sys/sys1/sys1-sp23/-/tree/master/src)`。

### 项目简介

本项目旨在使用 Verilog、C、C++ 和汇编语言等多种编程语言，自底向上实现基于 RISC-V 指令集的五级流水线 CPU 硬件设计，并在其上运行自行编写的操作系统代码。

### 项目结构

* **硬件部分 (hardware)**

  使用硬件描述语言 Verilog 和 SystemVerilog 进行 CPU 的电路设计，采用模块化的设计思想，最终实现五级流水线 CPU。

  功能实现包括：
  - 流水线 CPU 中的停顿（stall）和转发（forwarding）处理
  - 特权指令处理（CSR 寄存器流水线）
  - 基于分支历史表（BHT）和分支目标缓冲区（BTB）的动态分支预测
  - 二路组相连缓存（Cache）
  - 内存管理单元（MMU），实现虚实地址翻译和访问权限控制

* **软件内核部分 (kernel)**

  使用 RISC-V 汇编语言和 C 语言编写 Linux 内核部分代码，并可采用 OpenSBI 作为软硬件接口实现在上述硬件平台上的正确运行。

  功能实现包括：
  - 中断处理（时钟中断）
  - 线程调度（使用最短剩余时间优先算法）
  - 基于 SV39 模式的虚拟内存系统
  - 用户模式和内核模式的分离
  - 虚拟内存缺页处理（demand paging）
  - fork 系统调用（使用写时复制机制）
